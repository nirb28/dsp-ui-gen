##############################################################################
# FD2 Multi-Endpoint Chatbot - Multiple FD2 endpoints with JWT auth
# Shows endpoint selector so user can switch between query modes.
# Access at: http://localhost:8200/fd2-multi-endpoint/login
##############################################################################
name: "AI Research Assistant"
description: "Multi-mode AI assistant with query expansion and retrieval"

params:
  - name: "project"
    label: "Project"
    default: "sas2py"

theme:
  primary_color: "#7c3aed"
  secondary_color: "#6d28d9"
  accent_color: "#8b5cf6"
  background_color: "#faf5ff"
  text_color: "#1e293b"

auth:
  type: "jwt_endpoint"
  endpoint: "http://127.0.0.1:8080/{{project}}/auth/token"
  username_field: "username"
  password_field: "password"
  token_response_field: "access_token"
  session_duration_minutes: 480

chat:
  system_prompt: "You are a research assistant with access to multiple knowledge sources."
  placeholder: "Paste your SAS code here, or type a question..."
  welcome_message: "Welcome! I'm your research assistant. Select an endpoint above and ask away."
  input:
    type: "code"
    rows: 6
    max_rows: 15
    language: "sas"
    label: "Input"
    submit_on_enter: false
  show_endpoint_selector: true
  endpoints:
    - name: "smart-query"
      url: "http://localhost:8080/query"
      method: "POST"
      headers:
        Authorization: "Bearer {{token}}"
      body_template:
        query: "{{message}}"
        configuration_name: "default"
        use_reranking: true
        query_expansion:
          enabled: true
          strategy: "fusion"
          llm_config_name: "groq-llama3"
          num_queries: 3
      response_field: "response"

    - name: "basic-query"
      url: "http://localhost:8080/query"
      method: "POST"
      headers:
        Authorization: "Bearer {{token}}"
      body_template:
        query: "{{message}}"
        configuration_name: "default"
      response_field: "response"

    - name: "retrieve-docs"
      url: "http://localhost:8080/retrieve"
      method: "POST"
      headers:
        Authorization: "Bearer {{token}}"
      body_template:
        query: "{{message}}"
        configuration_name: "default"
        top_k: 10
      response_field: "documents"

    - name: "sas2py-convert"
      url: "http://127.0.0.1:8080/{{project}}/convert"
      method: "POST"
      headers:
        Content-Type: "application/json"
        Authorization: "Bearer {{token}}"
      body_template:
        template_name: "converter"
        user_input: "{{message}}"
      response_field: "choices.0.message.content"

    - name: "sas2py-openai"
      url: "http://127.0.0.1:8080/{{project}}/v1/chat/completions"
      method: "POST"
      headers:
        Content-Type: "application/json"
        Authorization: "Bearer {{token}}"
      body_template:
        model: "openai/gpt-oss-120b"
        messages:
          - role: "system"
            content: "You are an expert SAS to Python code converter. Convert SAS code to equivalent Python code using pandas, numpy, and other standard libraries. Maintain the same logic and output format."
          - role: "user"
            content: "{{message}}"
        max_tokens: 200
        temperature: 1.00
        top_p: 1.00
        frequency_penalty: 0.00
        presence_penalty: 0.00
        stream: false
      response_field: "choices.0.message.content"
      response_display:
        - field: "choices.0.message.content"
          label: "Response"
          type: "code"
        - field: "model"
          label: "Model"
          type: "text"
        - field: "usage"
          label: "Token Usage"
          type: "table"
